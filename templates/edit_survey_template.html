{% extends 'boilerplates/base_navbar.html' %}
{% load static %}
{% load widget_tweaks %}

{% block title %}Add Survey{% endblock %}

{% block content %}
<div class="content-wrapper">
  <div class="row">
    <div class="col-12">
    {% if userRole != 'Student' %}
    <div class="col-12 grid-margin stretch-card">
      <div class="card">
        <div class="card-body">
          <form method="post">
            {% csrf_token %}
            <h4 class="card-title">Edit Survey</h4>
            <div class="form-group">
              <label for="template_name">Template</label>
              <div>
                <select name="template_name" class="form-select" id="template_name" onchange="if(this.options[this.selectedIndex].value=='customOption'){
                toggleField(this,this.nextSibling);
                this.selectedIndex='0';
                }">
                {% if survey_template_name == "Default Template" %}
                    <option selected> Default Template </option>
                    <option value="customOption"> Create Template </option>
                    </select><input type="text" name="template_name" class="form-control" id="template_name" style="display:none;" placeholder="Template Name" disabled="disabled"
                    onblur="if(this.value==''){toggleField(this,this.previousSibling);}">
                {% else %}
                    <option selected> {{ survey_template_name }} </option>
                    <option> Default Template </option>
                    <option value="customOption"> Create Template </option>
                    </select><input type="text" name="template_name" class="form-control" id="template_name" style="display:none;" placeholder="Template Name" disabled="disabled"
                    onblur="if(this.value==''){toggleField(this,this.previousSibling);}">
                {% endif %}
              </div>
            </div>
            <div class="form-group">
              <label for="instructions">Instruction(optional)</label>
              <input type="text" name="instructions" class="form-control" id="instructions" placeholder="Instruction" value = "{{ survey_template_instruction }}">
            </div>
            <div class="form-group">
              <label for="other_info">Additional information(optional)</label>
              <input type="text" name="other_info" class="form-control" id="other_info" placeholder="Additional information" value = "{{survey_template_other_info}}">
            </div>
            <div class="form-group">
              <label for="date_released">Release Date</label>
              <input type="text" name="date_released" class="form-control datetimepicker" id="date_released" placeholder="Release Date" value="{{ feedback_survey_date_released.date|date:"Y-m-d" }}" required>
            </div>
            <div class="form-group">
              <label for="date_due">Due Date</label>
              <input type="text" name="date_due" class="form-control datetimepicker" id="date_due" placeholder="Due Date" value = "{{ feedback_survey_date_due.date|date:"Y-m-d" }}" required>
            </div>

            <button type="submit" class="btn btn-primary me-2">Save</button>
          </form>
        </div>
      </div>
    </div>
    {% endif %}

    </div>
  </div>
</div>
{% endblock content %}

{% block js %}
<script>
  function toggleField(hideObj, showObj) {
    hideObj.disabled = true;
    hideObj.style.display = 'none';
    showObj.disabled = false;
    showObj.style.display = 'inline';
    showObj.focus();
  }


</script>
<script>
  $('.datetimepicker').each(function () {
    new tempusDominus.TempusDominus(this, {
      display: {
        components: {
          seconds: true
        },
      },
    });
  });
</script>


{% endblock %}